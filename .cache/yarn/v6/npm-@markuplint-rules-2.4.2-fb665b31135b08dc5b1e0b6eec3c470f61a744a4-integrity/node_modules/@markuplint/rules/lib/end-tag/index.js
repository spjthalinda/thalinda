"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ml_core_1 = require("@markuplint/ml-core");
const voidElements = [
    'area',
    'base',
    'br',
    'col',
    'embed',
    'hr',
    'img',
    'input',
    'link',
    'meta',
    'param',
    'source',
    'track',
    'wbr',
];
exports.default = (0, ml_core_1.createRule)({
    defaultServerity: 'warning',
    async verify({ document, report, t }) {
        if (document.endTag === 'never') {
            return;
        }
        await document.walkOn('Element', el => {
            var _a;
            if (voidElements.some(vE => vE === el.nodeName.toLowerCase())) {
                return;
            }
            if (el.closeTag != null) {
                return;
            }
            if ((document.endTag === 'xml' || el.isForeignElement) && ((_a = el.selfClosingSolidus) === null || _a === void 0 ? void 0 : _a.raw)) {
                return;
            }
            report({
                scope: el,
                message: t('Missing {0}', t('the {0}', 'end tag')),
            });
        });
    },
});
