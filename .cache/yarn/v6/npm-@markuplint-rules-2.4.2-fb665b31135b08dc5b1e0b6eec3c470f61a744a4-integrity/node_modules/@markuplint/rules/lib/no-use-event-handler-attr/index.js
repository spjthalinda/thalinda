"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ml_core_1 = require("@markuplint/ml-core");
const helpers_1 = require("../helpers");
exports.default = (0, ml_core_1.createRule)({
    defaultServerity: 'warning',
    defaultOptions: {},
    async verify({ document, report, t }) {
        await document.walkOn('Element', el => {
            if (el.isCustomElement) {
                return;
            }
            const ignoreList = Array.isArray(el.rule.option.ignore)
                ? el.rule.option.ignore
                : el.rule.option.ignore
                    ? [el.rule.option.ignore]
                    : [];
            el.attributes.forEach(attr => {
                const name = attr.getName().potential;
                for (const ignore of ignoreList) {
                    if ((0, helpers_1.match)(name, ignore)) {
                        return;
                    }
                }
                if (/^on/i.test(name)) {
                    report({
                        scope: el,
                        raw: attr.raw,
                        line: attr.startLine,
                        col: attr.startCol,
                        message: t('{0} is disallowed', t('the "{0*}" {1}', name, 'attribute')),
                    });
                }
            });
        });
    },
});
