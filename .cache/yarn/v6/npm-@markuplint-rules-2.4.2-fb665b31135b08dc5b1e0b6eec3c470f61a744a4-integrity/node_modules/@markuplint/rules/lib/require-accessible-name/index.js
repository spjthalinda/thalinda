"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ml_core_1 = require("@markuplint/ml-core");
const helpers_1 = require("../helpers");
exports.default = (0, ml_core_1.createRule)({
    async verify({ document, report, t }) {
        await document.walkOn('Element', el => {
            if ((0, helpers_1.accnameMayBeMutable)(el, document)) {
                return;
            }
            const role = (0, helpers_1.getComputedRole)(document.specs, el);
            if (!role) {
                return;
            }
            const roleSpec = (0, helpers_1.getRoleSpec)(document.specs, role.name);
            if (!roleSpec || !roleSpec.accessibleNameRequired) {
                return;
            }
            const hasAccessibleName = !!el.getAccessibleName().trim();
            if (!hasAccessibleName) {
                report({ scope: el, message: t('Require {0}', 'accessible name') });
            }
        });
    },
});
