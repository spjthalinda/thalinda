"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkMultiTypes = void 0;
const debug_1 = require("./debug");
const match_result_1 = require("./match-result");
function checkMultiTypes(value, checks) {
    let unmatched;
    for (const check of checks) {
        const res = check(value);
        if (res.matched) {
            return res;
        }
        // @ts-ignore
        res._fn = check.name;
        // @ts-ignore
        (0, debug_1.log)('%s(%d) vs %s(%d)', unmatched === null || unmatched === void 0 ? void 0 : unmatched._fn, unmatched === null || unmatched === void 0 ? void 0 : unmatched.passCount, res._fn, res.passCount);
        const passedA = (unmatched === null || unmatched === void 0 ? void 0 : unmatched.passCount) || 0;
        const passedB = res.passCount || 0;
        const offsetA = (unmatched === null || unmatched === void 0 ? void 0 : unmatched.offset) || 0;
        const offsetB = res.offset;
        if (passedA < passedB || (passedA === passedB && offsetA <= offsetB)) {
            unmatched = res;
        }
    }
    const result = unmatched || (0, match_result_1.matched)();
    (0, debug_1.log)('%d checks result: %O', checks.length, result);
    return result;
}
exports.checkMultiTypes = checkMultiTypes;
